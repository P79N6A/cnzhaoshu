var scrollTop,scrollTopTreeView,isMine=!1,platformid,flagid,share,dictionary_attributes,attribute_name={5:"\u80f8\u5f84",6:"\u5730\u5f84",7:"\u76c6\u5f84",10:"\u682a\u9ad8",11:"\u6761\u957f",12:"\u4e3b\u8513\u957f",17:"\u682a\u9ad8"};function $(b){return document.getElementById(b)}function urlRequest(b){return(b=RegExp("[?&]"+b+"=([^&]*)").exec(window.location.search))&&decodeURIComponent(b[1].replace(/\+/g," "))}function getcookie(b){for(var a=document.cookie.split("; "),c=0;c<a.length;c++){var d=a[c].split("=");if(d[0]==b)return unescape(d[1])}}function loadJS(b){var a=document.createElement("script");a.src=b;document.body.appendChild(a)}function showTime(b){b=b.replace(/-/g,"/");b=new Date(b);b=(new Date).getTime()-b.getTime();return 36E5>b?(b=Math.floor(b/ 6E4), 0 == b ? "\u521a\u521a" : b + "\u5206\u949f\u524d") : 864E5 > b ? Math.floor(b /36E5)+"\u5c0f\u65f6\u524d":2592E6>b?Math.floor(b/ 864E5) + "\u5929\u524d" : 31104E6 > b ? Math.floor(b /2592E6)+"\u6708\u524d":"1\u5e74\u524d"}function stringTrim(b){return b.replace(/(^\s*)|(\s*$)/g,"")}function mORcm(b){return 1>b?Math.round(100*b)+"\u516c\u5206":b+"\u7c73"}function mORcmArray(b){return b?1>b?{value:100*b,unit:"\u516c\u5206"}:{value:b,unit:"\u7c73"}:{value:0,unit:"\u7c73"}}function inArray(b,a){for(var c in a)if(a[c]==b)return!0;return!1}var ajax=function(b,a){var c=window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest;c.open("GET",b,!0);c.onreadystatechange=function(){4==c.readyState&&(200==c.status||0==c.status)&&a&&a(c.responseText)};c.setRequestHeader("Content-Type","application/x-www-form-urlencoded");c.send(null);return!0};function initFromWhere(b){platformid=urlRequest("platformid");if(b=urlRequest("where"))try{b=JSON.parse(b),b.platformid&&(platformid=b.platformid),b.flagid&&(flagid=b.flagid),b.share&&(share=b.share)}catch(a){}"1020"==platformid&&document.body.removeChild($("footer_menu"))}function init(){user=JSON.parse(user);user.name||(user.name="\u65e0\u540d\u5927\u5496");user.phone||(user.phone="\u672a\u6ce8\u518c\u624b\u673a");"undefined"!=typeof visitor&&(visitor=JSON.parse(visitor),isMine=visitor.userid==user.userid);trees="null"!=trees?JSON.parse(trees):[];var b=0,a;for(a in trees)b+=1*trees[a].count;a=5>=user.name.length&&0<trees.length?trees[0].province+trees[0].district:"";document.title=window.isShop?a+user.name:user.name+"\u7684\u627e\u6811\u8f66";a="";if(isMine){var c=window.isShop?"1020"==platformid||"gh_2b5bfe05ef68"==urlRequest("platform_id")?"\u81ea\u6709\u82d7\u6728":"\u6211\u7684\u82d7\u5e97":"\u6211\u7684\u627e\u6811\u8f66";a+=c+'<br><a href="tel:'+user.phone+'">\u260f  '+user.phone+'</a><br><i id="total">'+trees.length+"\u9879"+b+"\u682a</i>"}else c=window.isShop?user.name:user.name+"\u7684\u627e\u6811\u8f66",a+=c.length>Math.floor(window.screen.width/ 24) ? '<p style="font-size:' + Math.floor(window.screen.width /c.length)+'px">'+c+"</p>":"<p>"+c+"</p>",a+=window.isShop?'<a href="tel:'+user.phone+'">\u260f'+user.phone+'</a><br><i id="total" style="font-size:14px">'+trees.length+"\u9879"+b+"\u682a</i>":'<a href="tel:'+user.phone+'">\u260f'+user.phone+'</a><br><i id="total">'+trees.length+"\u9879"+b+"\u682a</i>";0<trees.length&&(a+='<a class="poi" href="http://apis.map.qq.com/uri/v1/marker?marker=coord:'+trees[0].x+","+trees[0].y+";title:"+user.name+";addr:"+trees[0].address+'&referer=geo"> </a>');a+=window.isShop?'<a class="excel" href="excel.shop.php?userid='+user.userid+'"></a>':'<a class="excel" href="excel.cart.php?userid='+user.userid+'"></a>';a+='<a class="headimg" href="javascript:sildeAllImage()"><img src="headimg/96/'+(window.isShop?user.shopid:user.userid)+".jpg?t="+user.version+'"></a>';$("title").innerHTML=a;window.isShop&&user.video&&(b=document.createElement("div"),b.innerHTML='<video preload="none" controls="controls" poster="/trees/video/'+user.video+'.jpg" width="100%" webkit-playsinline><source src="/trees/video/'+user.video+'.mp4" type="video/mp4" /></video>',document.body.insertBefore(b,$("title")));window.isShop&&user.introduction&&addUserIntroduction();delete user.introduction;setTimeout(addTrees,50);window.isShop&&window.visitor&&visitor.shopid!=user.shopid&&(b="com/visitshop.php?shopid="+user.shopid+"&userid="+user.userid+"&visitorid="+visitor.userid,flagid&&(b+="&flagid="+flagid),"undefined"!=typeof share&&(b+="&type="+share),ajax(b))}function addUserIntroduction(){var b=document.createElement("ul");b.innerHTML=website_filter(user.introduction);$("treelist").appendChild(b)}function addTrees(b){dictionary_attributes=isMine&&localStorage.attributes2?JSON.parse(localStorage.attributes2):{};var a=[],c;for(c in trees){var d=trees[c];b||(d.basicname=d.name,d.pname&&(d.name="'"+d.pname+"'"+d.name),d.age&&(d.age=parseFloat(d.age)),d.dbh&&(d.dbh=parseFloat(d.dbh)),d.height&&(d.height=parseFloat(d.height)),d.crownwidth&&(d.crownwidth=parseFloat(d.crownwidth)),d.branch_point_height&&(d.branch_point_height=parseFloat(d.branch_point_height)),d.price=Math.round(100*d.price)/100,isMine||0!=d.price||(d.price="\u8bae\u4ef7"),d.unit||(d.unit="\u682a"),d.imgpath&&(d.imgpath=decodeImgpath(d.imgpath)),d.phototime&&(d.phototime=d.phototime.split(";"),d.photogps=d.photogps.split(";")),window.isShop&&(d.username=user.name,d.phone=user.phone),!isMine||dictionary_attributes[d.basicname]||inArray(d.basicname,a)||a.push('"'+d.basicname+'"'));var e=document.createElement("li");e.innerHTML=treeInnerHTML(d,c);$("treelist").appendChild(e)}try{prepareShare()}catch(f){}isMine&&0<a.length&&ajax("com/dictionary_attribute_bynames.php?names="+a.join(","),function(a){a=JSON.parse(a);for(var b in a){var c=a[b];dictionary_attributes[c.name]=c.attribute}delete localStorage.attributes;localStorage.attributes2=JSON.stringify(dictionary_attributes)})}function treeInnerHTML(b,a){var c="";switch(b.state){case 2:c='<span class="renzheng">\u5df2\u8ba4\u8bc1</span>';break;case 3:c='<span class="qjd">\u65d7\u8230\u5e97</span>';break;case 4:c='<span class="qjd">\u5355\u54c1\u738b</span>'}var d=0<b.collections?'<span class="cangmi">\u85cf\u7c73'+b.collections+"</span>":"";a='<a href="javascript:showtree('+a+')">'+(b.imgpath?'<img src="/trees/s2/'+b.imgpath[0]+'" />':'<img alt="no image">');b.invoice&&(a+='<img class="fapiao" src="/img/fapiao.png?t=2">');b.userstate&&(a+='<img style="position: absolute; width: 40px; height: 40px; border-radius: 50%; margin: 50px 0 0 -40px;" onerror="this.parentNode.removeChild(this);" src="/platform/'+b.userstate+'.png">');b.phototime&&(a+='<div class="photomark"></div>');101!=b.type?(a+="<h2>"+b.name.substring(0,8)+"<span>\u00a5"+b.price+"</span> <i>"+showTime(b.time)+"</i>"+c+"</h2>",a+="<h3>"+attribute(b)+"</h3>",a+="<h3>"+b.username+"</h3>",a+="<h3>"+b.province+b.district+" "+b.count+b.unit+d+"</h3></a>"):(a+="<h2>"+b.name.substring(0,8)+" <i>"+showTime(b.time)+"</i>"+c+"</h2>",a+="<h3>"+b.remark+"</h3>",a+="<h3>"+b.username+"</h3>",a+="<h3>"+b.province+b.district+" "+d+"</h3></a>");return a}function attribute(b){var a=[];b.dbh&&a.push("\u5f84"+b.dbh+"\u516c\u5206");b.age&&a.push("\u9f84"+b.age+"\u5e74");b.crownwidth&&a.push("\u51a0"+mORcm(b.crownwidth));b.height&&a.push("\u9ad8"+mORcm(b.height));b.branch_point_height&&a.push("\u5206"+mORcm(b.branch_point_height));b.branch_bough_number&&a.push("\u679d"+b.branch_bough_number+"\u4e2a");return a.join(" ")}function showtree(b){var a=trees[b],c="";if(isMine&&window.isShop){var d=dictionary_attributes?dictionary_attributes[a.basicname]:null;d&&(d=d.split(","));c=c+'<div class="header"><a class="back" href="javascript:closetree()">\u8fd4\u56de</a></div><table>'+('<tr><th colspan="2">'+a.name+"</th></tr>");a.ldname&&(c+='<tr><td class="ldname" colspan="2">'+a.ldname+"</td></tr>");a.invoice&&(c+='<img class="fapiao" src="/img/fapiao.png?t=2">');c=a.qrcodeid?c+('<tr><td class="field">\u6811\u724c\uff1a</td><td>'+a.qrcodeid+"</td>"):c+('<tr><td class="field">\u7f16\u53f7\uff1a</td><td>'+a.treeid+"</td>");if(a.dbh||d&&inArray(a.dbh_type,d))c+='<tr><td class="field">'+(a.dbh_type?attribute_name[a.dbh_type]:"\u80f8\u5f84")+'\uff1a</td><td><input id="dbh" onkeyup="if(isNaN(value))execCommand(\'undo\')" onafterpaste="if(isNaN(value))execCommand(\'undo\')" type="text" placeholder\uff1d"\u4e0d\u8d85\u8fc7100" value="'+(a.dbh||0)+'"/>\u516c\u5206</td>';if(a.age||d&&inArray(8,d))c+='<tr><td class="field">\u82d7\u9f84\uff1a</td><td><input id="age" onkeyup="if(isNaN(value))execCommand(\'undo\')" onafterpaste="if(isNaN(value))execCommand(\'undo\')" type="text" placeholder\uff1d"\u4e0d\u8d85\u8fc71000" value="'+(a.age||0)+'"/>\u5e74</td>';if(a.crownwidth||d&&inArray(9,d))var e=mORcmArray(a.crownwidth),c=c+('<tr><td class="field">\u51a0\u5e45\uff1a</td><td><input id="crownwidth" onkeyup="if(isNaN(value))execCommand(\'undo\')" onafterpaste="if(isNaN(value))execCommand(\'undo\')" type="text" placeholder\uff1d"\u4e0d\u8d85\u8fc720" value="'+e.value+'"/><span>'+e.unit+"</span></td>");if(a.height||d&&inArray(a.height_type,d))e=mORcmArray(a.height),c+='<tr><td class="field">'+(a.height_type?attribute_name[a.height_type]:"\u682a\u9ad8")+'\uff1a</td><td><input id="height" onkeyup="if(isNaN(value))execCommand(\'undo\')" onafterpaste="if(isNaN(value))execCommand(\'undo\')" type="text" placeholder\uff1d"\u4e0d\u8d85\u8fc720" value="'+e.value+'"/><span>'+e.unit+"</span></td>";if(a.branch_point_height||d&&inArray(13,d))e=mORcmArray(a.branch_point_height),c+='<tr><td class="field">\u5206\u679d\u70b9\u9ad8\uff1a</td><td><input id="branch_point_height" onkeyup="if(isNaN(value))execCommand(\'undo\')" onafterpaste="if(isNaN(value))execCommand(\'undo\')" type="text" placeholder\uff1d"\u4e0d\u8d85\u8fc720" value="'+e.value+'"/><span>'+e.unit+"</span></td>";if(a.branch_bough_number||d&&inArray(14,d))c+='<tr><td class="field">\u5206\u679d\u6570\uff1a</td><td><input id="branch_bough_number" onkeyup="if(isNaN(value))execCommand(\'undo\')" onafterpaste="if(isNaN(value))execCommand(\'undo\')" type="text" placeholder\uff1d"\u4e0d\u8d85\u8fc710" value="'+(a.branch_bough_number||0)+'"/>\u4e2a</td>';101!=a.type&&(c+='<tr><td class="field">\u4e0a\u8f66\u5355\u4ef7\uff1a</td><td><input id="price" onkeyup="if(isNaN(value))execCommand(\'undo\')" onafterpaste="if(isNaN(value))execCommand(\'undo\')" type="text" placeholder\uff1d"\u5927\u4e8e0" value="'+a.price+'"/>\u5143</td></th>',c+='<tr><td class="field">\u6570\u91cf\uff1a</td><td><input id="count" onkeyup="if(isNaN(value))execCommand(\'undo\')" onafterpaste="if(isNaN(value))execCommand(\'undo\')" type="text" placeholder\uff1d"\u5927\u4e8e0\u5c0f\u4e8e10\u4e07" value="'+a.count+'"/>'+a.unit+"</td>");if(a.substrate||d&&inArray(19,d))c+='<tr><td class="field">\u57fa\u8d28\uff1a</td><td><textarea id="substrate" rows="1" placeholder="\u6700\u591a10\u4e2a\u5b57">'+(a.substrate||"")+"</textarea></td>";c+='<tr><td class="field">\u5907\u6ce8\uff1a</td><td><textarea id="remark" rows="3" placeholder="\u6700\u591a30\u4e2a\u5b57">'+(a.remark||"")+"</textarea></td>";c=c+"</table>"+('<button onclick="updatetree('+b+')">\u4fee\u6539\u82d7\u6728\u4fe1\u606f</button>')}else{d="";switch(a.state){case 2:d='<span class="renzheng">\u5df2\u8ba4\u8bc1</span>';break;case 3:d='<span class="qjd">\u65d7\u8230\u5e97</span>';break;case 4:d='<span class="qjd">\u5355\u54c1\u738b</span>'}c=c+('<div class="header"><a class="back" href="javascript:closetree()">\u8fd4\u56de</a>'+('<a class="poi" href="http://apis.map.qq.com/uri/v1/marker?marker=coord:'+a.x+","+a.y+";title:"+a.username+a.name+";addr:"+a.address+'&referer=geo"></a>')+d+(0<a.collections?'<span class="cangmi">\u85cf\u7c73'+a.collections+"</span>":"")+"</div>")+"<table>";c+='<tr><th colspan="2">'+a.name+"</th></tr>";a.ldname&&(c+='<tr><td class="ldname" colspan="2">'+a.ldname+"</td></tr>");101!=a.type&&(c+='<tr><td class="field">\u4e0a\u8f66\u5355\u4ef7\uff1a</td><td class="price">'+a.price+"</td></th>");c=a.qrcodeid?c+('<tr><td class="field">\u6811\u724c\uff1a</td><td>'+a.qrcodeid+"</td>"):c+('<tr><td class="field">\u7f16\u53f7\uff1a</td><td>'+a.treeid+"</td>");a.dbh&&(c+='<tr><td class="field">'+(a.dbh_type?attribute_name[a.dbh_type]:"\u80f8\u5f84")+"\uff1a</td><td>"+a.dbh+"\u516c\u5206</td>");a.age&&(c+='<tr><td class="field">\u82d7\u9f84\uff1a</td><td>'+a.age+"\u5e74</td>");a.crownwidth&&(c+='<tr><td class="field">\u51a0\u5e45\uff1a</td><td>'+mORcm(a.crownwidth)+"</td>");a.height&&(c+='<tr><td class="field">'+(a.height_type?attribute_name[a.height_type]:"\u682a\u9ad8")+"\uff1a</td><td>"+mORcm(a.height)+"</td>");a.branch_point_height&&(c+='<tr><td class="field">\u5206\u679d\u70b9\u9ad8\uff1a</td><td>'+mORcm(a.branch_point_height)+"</td>");a.branch_bough_number&&(c+='<tr><td class="field">\u5206\u679d\u6570\uff1a</td><td>'+a.branch_bough_number+"\u4e2a</td>");a.substrate&&(c+='<tr><td class="field">\u57fa\u8d28\uff1a</td><td>'+a.substrate+"</td>");a.remark&&(c+='<tr><td class="field">\u5907\u6ce8\uff1a</td><td>'+a.remark+"</td>");101!=a.type&&(c+='<tr><td class="field">\u6570\u91cf\uff1a</td><td>'+a.count+a.unit+"</td>");c+='<tr><td class="field">\u4f4d\u7f6e\uff1a</td><td>'+a.province+" "+a.district+"</td>";c+='<tr><td class="field">\u82d7\u5546\uff1a</td><td>'+a.username+"</td>";c+='<tr><td class="field">\u8054\u7cfb\u7535\u8bdd\uff1a</td><td><a href="tel:'+a.userphone+'">'+a.userphone+"</a></td>";c+='<tr><td class="field">\u53d1\u5e03\u65f6\u95f4\uff1a</td><td>'+a.time+"</td>";c+="</table>"}a.video&&(c+='<video preload="none" controls="controls" poster="/trees/video/'+a.video+'.jpg" width="100%" webkit-playsinline><source src="/trees/video/'+a.video+'.mp4" type="video/mp4" /></video></div>');if(a.imgpath)for(e in a.imgpath)a.phototime&&a.phototime[e]&&(c+='<div style="text-align:center;">'),c+='<a href="javascript:sildeTreeImage('+b+","+e+')"><img src="trees/o2/'+a.imgpath[e]+'" /></a>',a.phototime&&a.phototime[e]&&(c+='<br><a class="poi2" href="http://apis.map.qq.com/uri/v1/marker?marker=coord:'+a.photogps[e]+";title:"+a.username+a.name+";addr:"+a.address+'&referer=geo"></a><div class="phototime">'+a.phototime[e]+"</div></div>"),c+="</div>";if("undefined"!=typeof visitor&&(c=isMine&&window.isCart?c+('<button onclick="deletetree('+b+')">\u79fb\u51fa\u627e\u6811\u8f66</button>'):c+('<button onclick="addMyTree('+b+')">\u52a0\u5165\u627e\u6811\u8f66</button>'),visitor.istrader))if(1==a.state)c+='<button onclick="authenticateTree('+b+')">\u5355\u54c1\u8ba4\u8bc1</button>';else if(2==a.state||4==a.state)c+='<button onclick="decertificationTree('+b+')">\u53d6\u6d88\u8ba4\u8bc1</button>';isMine&&window.isShop&&(c+='<button onclick="toptree('+b+')">\u7f6e\u9876</button>',a.top&&(c+='<button onclick="untoptree('+b+')">\u53d6\u6d88\u7f6e\u9876</button>'),0<a.state&&(c+='<button onclick="offshelvestree('+b+')">\u4e0b\u67b6</button>'),-2==a.state&&(c+='<button onclick="onshelvestree('+b+')">\u4e0a\u67b6</button>'),c+='<button onclick="deletetree('+b+')">\u5220\u9664\u82d7\u6728</button>');window.isShop||(c+='<button onclick="gotoShop('+a.shopid+')">\u8fdb\u5165\u4ed6\u7684\u82d7\u5e97</button>');scrollTop=document.body.scrollTop;$("treelist").style.display="none";$("footer").style.display="none";document.body.scrollTop=0;b=document.createElement("div");b.id="treeview";b.innerHTML=c;document.body.appendChild(b);window.visitor&&visitor.shopid==a.shopid||ajax("com/accesstree.php?type=0&treeid="+a.treeid+"&shopid="+a.shopid+"&userid="+(window.visitor?visitor.userid:0),function(){})}function sildeAllImage(){var b='<div class="bd"><ul>',a;for(a in trees){var c=trees[a];if(c.imgpath)for(var d in c.imgpath)b+='<li data-id="'+a+","+d+'"></li>'}b+='</ul></div><div class="hd"><ul></ul></div>';$("treelist").style.display="none";$("footer").style.display="none";a=document.createElement("div");a.className="slideBox";a.id="imageview";a.innerHTML=b;document.body.appendChild(a);TouchSlide({slideCell:"#imageview",titCell:".hd ul",mainCell:".bd ul",effect:"left",delayTime:500,interTime:3500,autoPage:!0,autoPlay:!0,startFun:loadSildeImage});loadSildeImage(-1,2)}function loadSildeImage(b,a){if(++b<a&&(b=$("imageview").querySelector(".bd").querySelectorAll("li")[b],!b.innerHTML)){a=b.dataset.id.split(",");var c=trees[a[0]],d='<img onclick="closeAllImage()" src="trees/o2/'+c.imgpath[a[1]]+'"/>',d=d+("<span>"+c.name+"\u00a5"+c.price+" "+c.count+c.unit+" "+c.province+c.district+"<br>"+attribute(c)+"</span>");"undefined"==typeof visitor||isMine||(d+='<i onclick="addMyTree('+a[0]+')">\u2661</i>');b.innerHTML=d;b.style.height=document.body.scrollHeight+"px";b.style.verticalAlign="middle"}}function closeAllImage(){$("treelist").style.display="block";$("footer").style.display="block";document.body.removeChild($("imageview"))}function sildeTreeImage(b,a){var c=trees[b],d='<div class="bd"><ul>',e;for(e in c.imgpath)d+='<li><img onclick="closeImageView()" src="trees/o2/'+c.imgpath[e]+'"/>',d+="<span>"+c.name+"\u00a5"+c.price+" "+c.count+c.unit+" "+c.province+c.district+"<br>"+attribute(c)+"</span>","undefined"==typeof visitor||isMine||(d+='<i onclick="addMyTree('+b+')">\u2661</i>'),d+="</li>";d+='</ul></div><div class="hd"><ul></ul></div>';scrollTopTreeView=document.body.scrollTop;$("treeview").style.display="none";document.body.scrollTop=0;b=document.createElement("a");b.className="slideBox";b.id="imageview";b.innerHTML=d;document.body.appendChild(b);TouchSlide({slideCell:"#imageview",titCell:".hd ul",mainCell:".bd ul",effect:"left",defaultIndex:a,delayTime:500,interTime:3500,autoPage:!0,autoPlay:!0});a=$("imageview").querySelector(".bd").querySelectorAll("li");for(b=a.length-1;0<=b;b--)d=a[b],d.style.height=document.body.scrollHeight+"px",d.style.verticalAlign="middle"}function closeImageView(){$("treeview").style.display="block";document.body.removeChild($("imageview"));document.body.scrollTop=scrollTopTreeView}function closetree(b){$("treelist").style.display="block";$("footer").style.display="block";document.body.removeChild($("treeview"));document.body.scrollTop=scrollTop;if(null!=b)try{$("treelist").querySelectorAll("li")[b].style.display="none";trees[b].isDeleted=!0;var a=b=0,c;for(c in trees){var d=trees[c];d.isDeleted||(b+=1*d.count,a++)}$("total").innerHTML=a+"\u9879"+b+"\u682a"}catch(e){}}function gotoShop(b){window.location="shop.php?userid="+b}function deletetree(b){if(confirm("\u786e\u5b9a\u8981\u5220\u9664\u672c\u6761\u6570\u636e\u5417\uff1f")){var a=trees[b],c=user.shopid==a.shopid?"&isOwn=1":"";ajax(window.isCart?"com/deletemytree.php?userid="+user.userid+"&treeid="+a.treeid+c:"com/deletetree.php?treeid="+a.treeid,function(){});closetree(b)}}function updatetree(b){var a=trees[b],c={},d=parseFloat($("price").value);if(101==visitor.role){if(!d&&0!=d||0>d){alert("\u4ef7\u683c\uff1a\u5fc5\u987b\u5927\u4e8e0");return}}else if(!d||0>=d){alert("\u4ef7\u683c\uff1a\u5fc5\u987b\u5927\u4e8e0");return}a.price!=d&&(c.price=$("price").value=a.price=d);d=parseInt($("count").value);if(!d||0>=d||1E5<d)alert("\u6570\u91cf\uff1a\u53ea\u80fd\u4e3a 1\uff0d10\u4e07 \u7684\u6574\u6570");else{a.count!=d&&(c.count=$("count").value=a.count=d);if($("dbh")){d=parseFloat($("dbh").value);if(isNaN(d)||0>d||100<d){alert((a.dbh_type?attribute_name[a.dbh_type]:"\u80f8\u5f84")+"\uff1a\u4e0d\u5c0f\u4e8e0\uff0c\u4e0d\u8d85\u8fc7100");return}a.dbh!=d&&(c.dbh=$("dbh").value=a.dbh=d)}if($("crownwidth")){var e=parseFloat($("crownwidth").value),d="\u516c\u5206"==$("crownwidth").nextSibling.innerHTML?500:20;if(isNaN(e)||0>e||e>d){alert("\u51a0\u5e45\uff1a\u4e0d\u5c0f\u4e8e0\uff0c\u4e0d\u8d85\u8fc7"+d);return}"\u516c\u5206"==$("crownwidth").nextSibling.innerHTML&&(e/=100);a.crownwidth!=e&&(c.crownwidth=a.crownwidth=e)}if($("height")){e=parseFloat($("height").value);d="\u516c\u5206"==$("height").nextSibling.innerHTML?500:20;if(isNaN(e)||0>e||e>d){alert((a.height_type?attribute_name[a.height_type]:"\u682a\u9ad8")+"\uff1a\u4e0d\u5c0f\u4e8e0\uff0c\u4e0d\u8d85\u8fc72"+d);return}"\u516c\u5206"==$("height").nextSibling.innerHTML&&(e/=100);a.height!=e&&(c.height=a.height=e)}if($("age")){d=parseFloat($("age").value);if(isNaN(d)||0>d||1E3<d){alert("\u82d7\u9f84\uff1a\u4e0d\u5c0f\u4e8e0\uff0c\u4e0d\u8d85\u8fc71000");return}a.age!=d&&(c.age=$("age").value=a.age=d)}if($("branch_point_height")){e=parseFloat($("branch_point_height").value);d="\u516c\u5206"==$("branch_point_height").nextSibling.innerHTML?500:20;if(isNaN(e)||0>e||e>d){alert("\u5206\u679d\u70b9\u9ad8\uff1a\u4e0d\u5c0f\u4e8e0\uff0c\u4e0d\u8d85\u8fc7"+d);return}"\u516c\u5206"==$("branch_point_height").nextSibling.innerHTML&&(e/=100);a.branch_point_height!=e&&(c.branch_point_height=a.branch_point_height=e)}if($("branch_bough_number")){d=parseFloat($("branch_bough_number").value);if(isNaN(d)||0>d||10<d){alert("\u5206\u679d\u6570\uff1a\u4e0d\u5c0f\u4e8e0\uff0c\u4e0d\u8d85\u8fc710");return}a.branch_bough_number!=d&&(c.branch_bough_number=$("branch_bough_number").value=a.branch_bough_number=d)}$("substrate")&&(d=stringTrim($("substrate").value),d!=a.substrate&&(a.substrate||d)&&(c.substrate=$("substrate").value=a.substrate=d.substring(0,10)));$("remark")&&(d=stringTrim($("remark").value),d!=a.remark&&(a.remark||d)&&(c.remark=$("remark").value=a.remark=d.substring(0,30)));$("treelist").querySelectorAll("li")[b].innerHTML=treeInnerHTML(a,b);ajax("com/updatetree.php?treeid="+a.treeid+"&data="+JSON.stringify(c),function(){alert("\u4fee\u6539\u6210\u529f\uff01")})}}function addMyTree(b){b=trees[b];ajax("com/addmytree.php?userid="+visitor.userid+"&shopid="+b.userid+"&treeid="+b.treeid+(isMine?"&isOwn=1":""),function(){alert("\u52a0\u5165\u6210\u529f\uff01")})}function authenticateTree(b){trees[b].state=2;ajax("com/authenticatetree.php?userid="+visitor.userid+"&state=2&treeid="+trees[b].treeid,function(){alert("\u8ba4\u8bc1\u6210\u529f\uff01")})}function decertificationTree(b){trees[b].state=1;ajax("com/authenticatetree.php?userid="+visitor.userid+"&state=1&treeid="+trees[b].treeid,function(){alert("\u5df2\u53d6\u6d88\u8ba4\u8bc1\uff01")})}function toptree(b){var a=trees[b];trees.splice(b,1);trees.unshift(a);ajax("com/toptree.php?type=top&treeid="+a.treeid,function(a){for(a=trees.length-1;0<=a;a--)trees[a].isDeleted&&trees.splice(a,1);$("treelist").innerHTML="";closetree();addTrees(!0)})}function untoptree(b){ajax("com/toptree.php?type=untop&treeid="+trees[b].treeid,function(){window.location.href=window.location.href})}function offshelvestree(b){trees[b].state=-2;ajax("com/shelvestree.php?treeid="+trees[b].treeid+"&state=-2",function(){alert("\u5df2\u4e0b\u67b6\uff0c\u53ea\u6709\u81ea\u5df1\u53ef\u89c1")})}function onshelvestree(b){var a=user.isrenzheng?2:1;trees[b].state=a;ajax("com/shelvestree.php?treeid="+trees[b].treeid+"&state="+a,function(){alert("\u5df2\u4e0a\u67b6\uff0c\u641c\u7d22\u53ef\u89c1")})}function website_filter(b){var a=b.match(/http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w-   .\/?%&=]*)?/g);if(null!=a)for(var c=0;c<a.length;c++){var d=a[c].replace(/www./,"");b=b.replace(a[c],'<a class="website" href="'+d+'">'+d+"</a>")}a=b.match(/www.([\w-]+\.)+[\w-]+(\/[\w-   .\/?%&=]*)?/g);if(null!=a)for(c=0;c<a.length;c++)b=b.replace(a[c],'<a class="website" href="http://'+a[c]+'">'+a[c]+"</a>");return b}initFromWhere();init();0<navigator.userAgent.indexOf("MicroMessenger")&&loadJS("/js/wechat.js?t=201801022");setTimeout(function(){loadJS("/js/fastclick.min.js?t=20161205");var b=platformid?"<img onerror=\"this.src='http://qr.liantu.com/api.php?w=220&logo=http://cnzhaoshu.com/headimg/96/"+user.userid+".jpg&text=http://www.cnzhaoshu.com/shop.php?userid="+user.userid+'\'" src="http://qr.liantu.com/api.php?w=190&logo=http://cnzhaoshu.com/headimg/96/'+user.userid+'.jpg&text=http://www.cnzhaoshu.com/shop.php?where={"userid":"'+user.userid+'","platformid":"'+platformid+'"}">':'<img src="http://qr.liantu.com/api.php?w=190&logo=http://cnzhaoshu.com/headimg/96/'+user.userid+".jpg&text=http://www.cnzhaoshu.com/shop.php?userid="+user.userid+'">',b=b+(platformid?'<br><img src="/platform/wx'+platformid+'.png" onerror="this.src=\'/platform/wx.jpg\'">':'<br><img src="/platform/wx.jpg">'),b=b+'<p style="font-size:12px">\u5370\u5728\u540d\u7247\u4e0a\uff0c\u624b\u673a\u4e00\u626b\u53ef\u8fdb\u5e97</p>';$("footer").innerHTML=b;window.isShop&&ajax("com/qrcode.invite.php?shopid="+user.userid,function(){$("footer").innerHTML+='<img style="width:180px" src="/qrinvite/'+user.userid+'.jpg">'})},1E3);